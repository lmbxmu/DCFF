# Dynamic Filter Fusion for Training Compact CNNs (CVPR'21)

## CIFAR-10

### vgg16

#### epoch-300

```
2020-10-01-12:00:35

data_set: cifar10
data_path: /home/cbh/one/Dataset
train_batch_size: 256
test_batch_size: 256
num_epochs: 300
gpus: [0]
lr: 0.1
lr_decay_step: [150, 225]
momentum: 0.9
weight_decay: 0.0005
arch: vgg16
resume: None
test_only: False
job_dir: /media/disk1/cbh/EXP/2020/09/KL-score/cifar/vgg16/run-n/e-300/HRankP-cp3/r0
reset: False
cprate: [0.45]*7+[0.78]*5+[0.0]
t_expression: 1 - epoch / args.num_epochs
```



| run-n         | best top1  | FLOPs/M (PR)        | Params/M (PR)      |
| ------------- | ---------- | ------------------- | ------------------ |
| **vgg16**     | **93.96**  | **313.73M (0.0%)**  | **14.98 (0.0%)**   |
| **HRankPlus** | **93.10%** | **66.95M (78.6%)**  | **1.90 (87.3%)**   |
| 0             | 10         |                     |                    |
| 1             | 30.84      |                     |                    |
|               |            |                     |                    |
| e0            | 93.31      | **66.69M (78.76%)** | **1.64M (88.88%)** |
| e1            | 92.66      |                     |                    |
| e2            | 93.05      |                     |                    |
| e3            | 92.94      |                     |                    |
| e4            | **93.33**  |                     |                    |
| e5            | 92.57      |                     |                    |
| e6            | 92.57      |                     |                    |
| e7            | 92.89      |                     |                    |
| e8            | 92.89      |                     |                    |
| e9            | 92.88      |                     |                    |
| e10           | 93.14      |                     |                    |
| e11           | 93.00      |                     |                    |
| e12           | 92.78      |                     |                    |
| e13           | 93.22      |                     |                    |
| e14           | 92.79      |                     |                    |
| e15           | 92.93      |                     |                    |
| e16           | 93.15      |                     |                    |
| e17           | 92.95      |                     |                    |
| e18           | 93.00      |                     |                    |
| e19           | 93.11      |                     |                    |
| **avg**       |            |                     |                    |

<br>

### resnet56

#### epoch-300

```
2020-10-01-17:50:26

data_set: cifar10
data_path: /home/cbh/one/Dataset
train_batch_size: 256
test_batch_size: 256
num_epochs: 300
gpus: [1]
lr: 0.1
lr_decay_step: [150, 225]
momentum: 0.9
weight_decay: 0.0005
arch: resnet56
resume: None
test_only: False
job_dir: /media/disk1/cbh/EXP/2020/09/KL-score/cifar/res56/run-n/e-300/ABCP-cp1/r0
reset: False
cprate: [0.6]+[0.7]+[0.5]+[0.5]+[0.4]+[0.2]+[0.3]+[0.4]+[0.8] + [0.7]+[0.6]+[0.9]+[0.8]+[0.9]+[0.8]+[0.4]+[0.2]+[0.2] + [0.7]+[0.3]+[0.8]+[0.4]+[0.3]+[0.7]+[0.2]+[0.4]+[0.8] + [0.0]+[0.0]+[0.0]
t_expression: 1 - epoch / args.num_epochs
```



| run-n        | best top1/% | FLOPs/M (PR)        | Params/M (PR)      |
| ------------ | ----------- | ------------------- | ------------------ |
| **resnet56** | **93.26**   | **125.49M(0.0%)**   | **0.85M(0.0%)**    |
| **ABCPlus**  | **93.35**   | **57.54M (54.53%)** | **0.40M (53.25%)** |
| 0            | 80.69       |                     |                    |
| 1            |             |                     |                    |
|              |             |                     |                    |
|              |             |                     |                    |
|              |             |                     |                    |
|              |             |                     |                    |
| e0           | 92.23       | **57.54M (54.53%)** | **0.40M (53.25%)** |
| e1           | 92.68       |                     |                    |
| e2           | 91.59       |                     |                    |
| e3           | 92.82       |                     |                    |
| e4           | 91.73       |                     |                    |
| e5           | 92.17       |                     |                    |
| e6           | 92.85       |                     |                    |
| e7           | 91.81       |                     |                    |
| e8           | **93.25**   |                     |                    |
| e9           | 92.20       |                     |                    |
| e10          | 92.70       |                     |                    |
| e11          | 93.07       |                     |                    |
| e12          | 92.76       |                     |                    |
| e13          | 92.55       |                     |                    |
| e14          | 92.76       |                     |                    |
| e15          | 92.02       |                     |                    |
| e16          | 93.03       |                     |                    |
| e17          | 93.24       |                     |                    |
| e18          | 92.32       |                     |                    |
| e19          | 92.07       |                     |                    |

<br>

#### weight-decay

```
2020-10-03-00:50:32

data_set: cifar10
data_path: /home/cbh/one/Dataset
train_batch_size: 256
test_batch_size: 256
num_epochs: 300
gpus: [1]
lr: 0.1
lr_decay_step: [150, 225]
momentum: 0.9
weight_decay: 0.0006 ###
arch: resnet56
resume: None
test_only: False
job_dir: /media/disk1/cbh/EXP/2020/09/KL-score/cifar/res56/wd/e-300/ABCP-cp1/6e-4/r0
reset: False
cprate: [0.6]+[0.7]+[0.5]+[0.5]+[0.4]+[0.2]+[0.3]+[0.4]+[0.8] + [0.7]+[0.6]+[0.9]+[0.8]+[0.9]+[0.8]+[0.4]+[0.2]+[0.2] + [0.7]+[0.3]+[0.8]+[0.4]+[0.3]+[0.7]+[0.2]+[0.4]+[0.8] + [0.0]+[0.0]+[0.0]
t_expression: 1 - epoch / args.num_epochs


```

| weight-decay      | best top1/% | FLOPs/M (PR)        | Params/M (PR)      |
| ----------------- | ----------- | ------------------- | ------------------ |
| **resnet56**      | **93.26**   | **125.49M(0.0%)**   | **0.85M(0.0%)**    |
| **ABCPlus**       | **93.35**   | **57.54M (54.53%)** | **0.40M (53.25%)** |
| 5e-5 / r0         | 90.37       |                     |                    |
| 5e-5 / r1         | 91.14       |                     |                    |
| 5e-5 / r2         | 90.86       |                     |                    |
|                   |             |                     |                    |
| 5e-4 / run20-best | **93.25**   | **57.54M (54.53%)** | **0.40M (53.25%)** |
|                   |             |                     |                    |
| 6e-4 / r0         | **93.17**   |                     |                    |
| 6e-4 / r1         | 92.86       |                     |                    |
| 6e-4 / r2         | 92.65       |                     |                    |
|                   |             |                     |                    |
| 8e-4 / r0         | 92.76       |                     |                    |
| 8e-4 / r1         | **93.15**   |                     |                    |
| 8e-4 / r2         | 92.86       |                     |                    |
|                   |             |                     |                    |
| 1e-3 / r0         | 92.53       |                     |                    |
| 1e-3 / r1         | 92.17       |                     |                    |
| 1e-3 / r2         | 92.83       |                     |                    |
|                   |             |                     |                    |
| 5e-3 / r0         | 87.59       |                     |                    |
| 5e-3 / r1         | 87.33       |                     |                    |
| 5e-3 / r2         | 87.14       |                     |                    |
|                   |             |                     |                    |
| 5e-2 / r0         | 20.40       |                     |                    |
| 5e-2 / r1         | 19.80       |                     |                    |
| 5e-2 / r2         | 20.99       |                     |                    |



### resnet110

#### epoch-300

```
2020-10-01-20:11:19

data_set: cifar10
data_path: /home/cbh/one/Dataset
train_batch_size: 256
test_batch_size: 256
num_epochs: 300
gpus: [3]
lr: 0.1
lr_decay_step: [150, 225]
momentum: 0.9
weight_decay: 0.0005
arch: resnet110
resume: None
test_only: False
job_dir: /media/disk1/cbh/EXP/2020/09/KL-score/cifar/res110/run-n/e-300/ABCP-cp1/r1
reset: False
cprate: [0.2]+[0.0]+[0.2]+[0.3]+[0.6]+[0.7]+[0.1]+[0.3]+[0.3]+[0.4]+[0.7]+[0.7]+[0.5]+[0.1]+[0.3]+[0.0]+[0.6]+[0.0] + [0.2]+[0.5]+[0.0]+[0.6]+[0.7]+[0.5]+[0.7]+[0.7]+[0.3]+[0.4]+[0.0]+[0.3]+[0.1]+[0.5]+[0.0]+[0.1]+[0.0]+[0.7] + [0.0]+[0.1]+[0.3]+[0.3]+[0.3]+[0.1]+[0.2]+[0.5]+[0.7]+[0.2]+[0.4]+[0.7]+[0.5]+[0.7]+[0.7]+[0.7]+[0.5]+[0.1] + [0.6]+[0.2]+[0.5]
t_expression: 1 - epoch / args.num_epochs
```



| run-n         | top1-acc/% | FLOPs (PR)          | Params (PR)        |
| ------------- | ---------- | ------------------- | ------------------ |
| **resnet110** | **93.50**  | **252.89M (0.0%)**  | **1.72M(0.0%)**    |
| **ABCPlus**   | **93.70**  | **89.79M (65.07%)** | **0.58M (66.17%)** |
| 0             | 82.28      |                     |                    |
| 1             |            |                     |                    |
|               |            |                     |                    |
| e0            | 92.77      | **88.59M (65.26%)** | **0.58M (66.17%)** |
| e1            | 92.36      |                     |                    |
| e2            | 92.06      |                     |                    |
| e3            | 92.88      |                     |                    |
| e4            | 92.37      |                     |                    |
| e5            | 93.27      |                     |                    |
| e6            | 92.58      |                     |                    |
| e7            | 91.08      |                     |                    |
| e8            | 92.76      |                     |                    |
| e9            | 92.83      |                     |                    |
| e10           | 93.20      |                     |                    |
| e11           | 93.39      |                     |                    |
| e12           | 92.85      |                     |                    |
| e13           | 92.99      |                     |                    |
| e14           | 92.57      |                     |                    |
| e15           | 92.40      |                     |                    |
| e16           | 92.83      |                     |                    |
| e17           | 93.29      |                     |                    |
| e18           | 92.76      |                     |                    |
| e19           | **93.40**  |                     |                    |

<br>

### googlenet

#### epoch-300

```

```



| run-n         | top1-acc/% | FLOPs (PR)       | Params (PR)    |
| ------------- | ---------- | ---------------- | -------------- |
| **googlenet** | 95.03      | 1529.43M (0.0%)  | 6.17M (0.0%)   |
| **ABCPlus**   | 94.69      | 462.17M (69.88%) | 2.09M (66.16%) |
| 0             |            | 457.22M (70.11%) | 2.08M (66.28%) |
| 1             |            |                  |                |
| 2             |            |                  |                |
|               |            |                  |                |

<br>

## ImageNet

### resnet50

#### epoch-90

```

```



| run-n            | top1-acc/% | top5-acc/% | FLOPs (PR)         | Params (PR)        |
| ---------------- | ---------- | ---------- | ------------------ | ------------------ |
| **resnet50**     | **76.15**  | **92.96**  | **4.14B (0.0%)**   | **25.56M (0.0%)**  |
| **ABCPlus-60%*** | **73.70**  | **91.72**  | **1.31B (68.08%)** | **7.29M (71.49%)** |
| 0                |            |            | **1.31B (68.08%)** | **7.29M (71.49%)** |
| 1                |            |            |                    |                    |

<br>

### mobilenetv1

#### epoch-90

```

```



| run-n           | top1-acc/% | top5-acc/% | FLOPs (PR) | Params (PR) |
| --------------- | ---------- | ---------- | ---------- | ----------- |
| **mobilenetv1** |            |            |            |             |
|                 |            |            |            |             |
| 0               |            |            |            |             |
| 1               |            |            |            |             |

<br>



### mobilenetv2

#### epoch-90

```

```



| run-n           | top1-acc/% | top5-acc/% | FLOPs (PR) | Params (PR) |
| --------------- | ---------- | ---------- | ---------- | ----------- |
| **mobilenetv1** |            |            |            |             |
|                 |            |            |            |             |
| 0               |            |            |            |             |
| 1               |            |            |            |             |

<br>

